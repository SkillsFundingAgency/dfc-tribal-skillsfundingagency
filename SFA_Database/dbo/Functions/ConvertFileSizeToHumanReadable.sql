CREATE FUNCTION [dbo].[ConvertFileSizeToHumanReadable]
(
	@bytes int
)
RETURNS VARCHAR(20)
AS
BEGIN
	
	DECLARE @result VARCHAR(20)

	SELECT @result =
		CASE
			WHEN 
				@bytes <= 1024
			THEN 
				CONVERT(NVARCHAR, @bytes) + ' Bytes'
		    WHEN
				@bytes >1024 AND @bytes <= 1048576
			THEN 
				CONVERT(NVARCHAR, CAST(ROUND(CONVERT(DECIMAL(20,3),@bytes)/CONVERT(DECIMAL(20,3), 1024),3) AS FLOAT)) + ' KB'
			WHEN
				@bytes >1048576 AND @bytes <= 1073741824
			THEN
				CONVERT(NVARCHAR, CAST(ROUND(CONVERT(DECIMAL(20,3),@bytes)/CONVERT(DECIMAL(20,3),1048576), 3) AS FLOAT)) + ' MB'
			ELSE
				CONVERT(NVARCHAR, CAST(ROUND(CONVERT(DECIMAL(20,3),@bytes)/CONVERT(DECIMAL(20,3),2097152), 3) AS FLOAT)) + ' GB'
       END

	RETURN @result
END
GO